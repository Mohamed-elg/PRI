{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/share-data-service.service\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"../mechanical-sheet/mechanical-sheet.component\";\nexport class ApiPayload {\n  constructor(client, assemblage) {\n    this.client = client;\n    this.assemblage = assemblage;\n  }\n}\nexport class AddMechanicalSheetComponent {\n  constructor(shareDataService, http) {\n    this.shareDataService = shareDataService;\n    this.http = http;\n    this.mechanical_sheet_url = 'http://localhost:8081/api/FicheMecanique';\n  }\n  ngOnInit() {\n    this.shareDataService.currentClientValue.subscribe(value => {\n      this.client = value;\n    });\n    this.shareDataService.currentEquipmentsValues.subscribe(value => {\n      this.equipments = value;\n    });\n  }\n  onSubmit() {\n    console.log(this.client);\n    const payload = {\n      \"client\": {\n        \"id\": 0,\n        \"nom\": this.client.client,\n        \"ref\": this.client.ref,\n        \"contact\": {\n          \"id\": 0,\n          \"nom\": this.client.name,\n          \"tel\": this.client.phone,\n          \"mail\": this.client.mail\n        }\n      },\n      \"assemblage\": {\n        \"id\": 0,\n        \"moteurs\": [],\n        \"pompes\": [],\n        \"reducteurs\": [],\n        \"ventilateurs\": []\n      }\n    };\n    if (!!this.equipments) {\n      this.equipments.forEach(equipment => {\n        const equipmentType = equipment.selectedEquipement.toLowerCase();\n        const equipmentDetail = equipment.selectedDetail.toLowerCase();\n        const newEquipment = {\n          \"type\": equipmentDetail\n        };\n        payload.assemblage[equipmentType + 's'].push(newEquipment);\n      });\n    }\n    const payloadString = JSON.stringify(payload);\n    const authToken = localStorage.getItem('authToken');\n    if (!authToken) {\n      console.error('No token found in localStorage');\n      return;\n    }\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${authToken}`,\n      'Content-Type': 'application/json'\n    });\n    this.http.post(this.mechanical_sheet_url, payloadString, {\n      headers\n    }).subscribe(response => {\n      console.log('Post request successful:', response);\n    }, error => {\n      console.error('Error in post request:', error);\n    });\n  }\n  static #_ = this.ɵfac = function AddMechanicalSheetComponent_Factory(t) {\n    return new (t || AddMechanicalSheetComponent)(i0.ɵɵdirectiveInject(i1.ShareDataService), i0.ɵɵdirectiveInject(i2.HttpClient));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddMechanicalSheetComponent,\n    selectors: [[\"add-mechanical-sheet\"]],\n    decls: 4,\n    vars: 0,\n    consts: [[1, \"row\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"click\"]],\n    template: function AddMechanicalSheetComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"mechanical-sheet\");\n        i0.ɵɵelementStart(1, \"div\", 0)(2, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function AddMechanicalSheetComponent_Template_button_click_2_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵtext(3, \"Submit\");\n        i0.ɵɵelementEnd()();\n      }\n    },\n    dependencies: [i3.MechanicalSheetComponent],\n    styles: [\"button[_ngcontent-%COMP%] {\\n    background-color: #012061;\\n    border-color: #012061;\\n}\\n\\nbutton[_ngcontent-%COMP%]:hover {\\n    background-color: #000c25;\\n    border-color: #000c25;\\n}\\n\\nbutton[_ngcontent-%COMP%]:active {\\n    background-color: #000c25 !important;\\n    border-color: #000c25 !important;\\n}\\n\\n.row[_ngcontent-%COMP%]{\\n    margin: 5%;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvYWRkLW1lY2hhbmljYWwtc2hlZXQvYWRkLW1lY2hhbmljYWwtc2hlZXQuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLHlCQUF5QjtJQUN6QixxQkFBcUI7QUFDekI7O0FBRUE7SUFDSSx5QkFBeUI7SUFDekIscUJBQXFCO0FBQ3pCOztBQUVBO0lBQ0ksb0NBQW9DO0lBQ3BDLGdDQUFnQztBQUNwQzs7QUFFQTtJQUNJLFVBQVU7QUFDZCIsInNvdXJjZXNDb250ZW50IjpbImJ1dHRvbiB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzAxMjA2MTtcbiAgICBib3JkZXItY29sb3I6ICMwMTIwNjE7XG59XG5cbmJ1dHRvbjpob3ZlciB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzAwMGMyNTtcbiAgICBib3JkZXItY29sb3I6ICMwMDBjMjU7XG59XG5cbmJ1dHRvbjphY3RpdmUge1xuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDBjMjUgIWltcG9ydGFudDtcbiAgICBib3JkZXItY29sb3I6ICMwMDBjMjUgIWltcG9ydGFudDtcbn1cblxuLnJvd3tcbiAgICBtYXJnaW46IDUlO1xufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"names":["HttpHeaders","ApiPayload","constructor","client","assemblage","AddMechanicalSheetComponent","shareDataService","http","mechanical_sheet_url","ngOnInit","currentClientValue","subscribe","value","currentEquipmentsValues","equipments","onSubmit","console","log","payload","ref","name","phone","mail","forEach","equipment","equipmentType","selectedEquipement","toLowerCase","equipmentDetail","selectedDetail","newEquipment","push","payloadString","JSON","stringify","authToken","localStorage","getItem","error","headers","post","response","_","i0","ɵɵdirectiveInject","i1","ShareDataService","i2","HttpClient","_2","selectors","decls","vars","consts","template","AddMechanicalSheetComponent_Template","rf","ctx","ɵɵelement","ɵɵelementStart","ɵɵlistener","AddMechanicalSheetComponent_Template_button_click_2_listener","ɵɵtext","ɵɵelementEnd"],"sources":["C:\\Users\\ANAS\\Desktop\\pri5\\PRI\\web\\src\\app\\add-mechanical-sheet\\add-mechanical-sheet.component.ts","C:\\Users\\ANAS\\Desktop\\pri5\\PRI\\web\\src\\app\\add-mechanical-sheet\\add-mechanical-sheet.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ShareDataService } from '../services/share-data-service.service';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\n\nexport class ApiPayload {\n  constructor(\n    public client: {\n      \"id\": number,\n      \"nom\": string,\n      \"ref\": string,\n      \"contact\": {\n        \"id\": number,\n        \"nom\": string,\n        \"tel\": string,\n        \"mail\": string\n      }\n    },\n    public assemblage: {\n      \"id\": number,\n      \"moteurs\": {\n        \"marque\": string,\n        \"numSerie\": string,\n        \"typeMoteur\": string,\n        \"id\": number\n      }[],\n      \"pompes\": {\n        \"id\": number,\n        \"marque\": string,\n        \"numSerie\": string\n      }[],\n      \"reducteurs\": {\n        \"id\": number,\n        \"marque\": string,\n        \"numSerie\": string\n      }[],\n      \"ventilateurs\": {\n        \"id\": number,\n        \"marque\": string,\n        \"numSerie\": string\n      }[]\n    }\n  ) {}\n}\n\n@Component({\n  selector: 'add-mechanical-sheet',\n  templateUrl: './add-mechanical-sheet.component.html',\n  styleUrls: ['./add-mechanical-sheet.component.css']\n})\nexport class AddMechanicalSheetComponent implements OnInit{\n  client!: any;\n  equipments!: any;\n  mechanical_sheet_url = 'http://localhost:8081/api/FicheMecanique';\n\n  constructor(private shareDataService: ShareDataService, private http: HttpClient) {}\n\n  ngOnInit(): void {\n    this.shareDataService.currentClientValue.subscribe(value => {\n      this.client = value;\n    });\n    this.shareDataService.currentEquipmentsValues.subscribe(value => {\n      this.equipments = value;\n    });  \n  }\n  \n  onSubmit() {\n    console.log(this.client);\n\n    const payload = {\n      \"client\": {\n        \"id\": 0,\n        \"nom\": this.client.client,\n        \"ref\": this.client.ref,\n        \"contact\": {\n          \"id\": 0,\n          \"nom\": this.client.name,\n          \"tel\": this.client.phone,\n          \"mail\": this.client.mail\n        }\n      },\n      \"assemblage\": {\n        \"id\": 0,\n        \"moteurs\": [],\n        \"pompes\": [],\n        \"reducteurs\": [],\n        \"ventilateurs\": []\n      }\n    }\n\n    if(!!this.equipments){\n      this.equipments.forEach((equipment: any) => {\n        const equipmentType = equipment.selectedEquipement.toLowerCase();\n        const equipmentDetail = equipment.selectedDetail.toLowerCase();\n  \n        const newEquipment = {\n          \"type\" : equipmentDetail,\n        };\n  \n        (payload.assemblage as any)[equipmentType+'s'].push(newEquipment);\n  \n      });\n    }\n\n    const payloadString = JSON.stringify(payload);\n\n    const authToken = localStorage.getItem('authToken');\n\n    if (!authToken) {\n      console.error('No token found in localStorage');\n      return;\n    }\n\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${authToken}`,\n      'Content-Type': 'application/json'\n    });\n\n    this.http.post(this.mechanical_sheet_url, payloadString, { headers })\n      .subscribe(response => {\n        console.log('Post request successful:', response);\n      }, error => {\n        console.error('Error in post request:', error);\n      });\n  }\n}","<mechanical-sheet></mechanical-sheet>\n\n<div class=\"row\">\n    <button type=\"submit\" class=\"btn btn-primary\" (click)=\"onSubmit()\">Submit</button>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}